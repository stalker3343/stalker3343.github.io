(function(t){function e(e){for(var a,i,l=e[0],s=e[1],c=e[2],d=0,f=[];d<l.length;d++)i=l[d],o[i]&&f.push(o[i][0]),o[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,l=1;l<r.length;l++){var s=r[l];0!==o[s]&&(a=!1)}a&&(n.splice(e--,1),t=i(i.s=r[0]))}return t}var a={},o={app:0},n=[];function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=s;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"20ad":function(t,e,r){"use strict";var a=r("6151"),o=r.n(a);o.a},"257b":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("f751"),r("097d");var a=r("2b0e"),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-toolbar",{attrs:{app:"",dark:"",color:"primary"}},[r("v-toolbar-title",[r("div",[t._v("Админ панель")])]),r("v-spacer"),r("v-toolbar-items",[t._l(t.links,function(e){return r("v-btn",{key:e.title,attrs:{to:e.url,flat:""}},[t._v(t._s(e.title))])}),t.isUserLogedIn?r("v-btn",{attrs:{flat:""},on:{click:t.logOut}},[t._v("Выйти")]):t._e()],2)],1),r("v-content",[r("router-view")],1)],1)},n=[],i={methods:{logOut:function(){this.$store.dispatch("logout"),this.$router.push("/login")}},computed:{isUserLogedIn:function(){return this.$store.getters.isUserLogedIn},links:function(){return this.isUserLogedIn?[{title:"Главная",url:"/"}]:[{title:"Войти",url:"/login"}]}}},l=i,s=r("2877"),c=Object(s["a"])(l,o,n,!1,null,null,null),u=c.exports,d=r("8c4f"),f=r("8aa5"),v=function(t,e,r){f["auth"]().currentUser?r():r("./login?loginError=true")},p=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{dark:"",color:"primary"}},[r("v-toolbar-title",[t._v("Форма входа")])],1),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{rules:t.emailRules,required:"","prepend-icon":"email",name:"login",label:"Почта (email@gmail.com)",type:"email"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("v-text-field",{attrs:{rules:[function(t){return!!t||"Введите пароль"}],required:"",id:"password","prepend-icon":"lock",name:"password",label:"Пароль(password)",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{loading:t.loading,disabled:!t.valid||t.loading,color:"primary"},on:{click:t.onSubmit}},[t._v("Войти")])],1)],1)],1)],1)],1)},h=[],g={data:function(){return{valid:!1,email:"",password:"",emailRules:[function(t){return!!t||"Введите Email"},function(t){return/.+@.+/.test(t)||"Введите коректный Email"}]}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var t=this;if(this.$refs.form.validate()){var e={email:this.email,password:this.password};this.$store.dispatch("loginUser",e).then(function(){t.$router.push("/")}).catch(function(t){return alert(t)})}}},created:function(){this.$route.query["loginError"]&&alert("Войдите в систему")}},m=g,b=Object(s["a"])(m,p,h,!1,null,null,null),x=b.exports,w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},t._l(t.tovarGRoup,function(e,a){return r("v-flex",{key:a,attrs:{xs12:"",sm6:"",lg3:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("div",[r("h3",{staticClass:"headline mb-0"},[t._v(t._s(e))])])]),r("v-card-actions",[r("v-btn",{attrs:{to:{name:"GroupItem",params:{group:a,name:e}},flat:"",color:"orange"}},[t._v("Перейти")])],1)],1)],1)}),1)],1)},y=[],k={data:function(){return{tovarGRoup:{}}},created:function(){var t=this;f["database"]().ref("tovarGroup").once("value").then(function(e){t.tovarGRoup=e.val()})}},_=k,O=Object(s["a"])(_,w,y,!1,null,null,null),E=O.exports,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("h1",[t._v(t._s(t.name))])]),r("v-layout",{attrs:{row:"",wrap:"","align-start":"","justify-start":"","fill-height":""}},t._l(t.tovarList,function(e,a){return r("v-flex",{key:a,attrs:{xs12:"",sm6:"",lg3:""}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("div",[r("h3",{staticClass:"headline mb-0"},[t._v(t._s(e.title))])])]),r("v-card-actions",[r("v-btn",{attrs:{flat:"",color:"orange"},on:{click:function(r){return t.dellTovar(a,e.roads)}}},[t._v("Удалить")]),r("uppdateTovar",{attrs:{id:a},on:{reload:t.reload}})],1)],1)],1)}),1),r("v-layout",{attrs:{row:"",wrap:""}},[r("addTovar",{on:{reload:t.reload}})],1)],1)},S=[],M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-dialog",{attrs:{width:"800px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-btn",{staticClass:"success",attrs:{slot:"activator"},slot:"activator"},[t._v("Добаввить товар")]),r("v-card",[r("v-container",[r("v-layout",[r("v-flex",{attrs:{"xs-12":""}},[r("v-card-title",[r("h1",[t._v("Добавление товара")])])],1)],1),t.loading?r("div",{staticClass:"text-xs-center"},[r("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):r("v-layout",[r("v-flex",{attrs:{"xs-12":""}},[r("v-card-text",[r("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{rules:t.titleRules,label:"Название",required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{rules:t.priceRules,label:"Цена",required:""},model:{value:t.priceNew,callback:function(e){t.priceNew=e},expression:"priceNew"}})],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{label:"Старая цена"},model:{value:t.priceOld,callback:function(e){t.priceOld=e},expression:"priceOld"}}),r("p",{staticClass:"caption subtitle"},[t._v("Оставить пустым если нет скидки на товар")])],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-btn",{attrs:{color:"warning"},on:{click:t.clockLoadImg}},[r("v-icon",{attrs:{left:""}},[t._v("cloud_upload")]),t._v("загрузить картинки\n                    ")],1),r("input",{ref:"inputPhoto",staticStyle:{display:"none"},attrs:{type:"file",name:"photo",id:"photo",accept:".jpg",multiple:""},on:{change:t.loadImg}}),r("v-alert",{directives:[{name:"show",rawName:"v-show",value:t.showError,expression:"showError"}],attrs:{type:"error"}},[t._v("Загрузите картинки")])],1)],1)],1)],1),r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:"","align-start":"","justify-start":"","fill-height":""}},t._l(t.imageSrc,function(t){return r("v-flex",{key:t,attrs:{xs12:"",md2:""}},[r("img",{attrs:{src:t,alt:""}})])}),1)],1),r("h1",[t._v("Описание")]),r("quill-editor",{ref:"myTextEditor",model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"error"},on:{click:function(e){t.dialog=!t.dialog}}},[t._v("ОТменить")]),r("v-btn",{attrs:{color:"success"},on:{click:t.addTovar}},[t._v("Добавить")])],1)],1)],1)],1)],1)],1)},$=[],L=(r("7f7f"),r("ac6a"),r("96cf"),r("3b8d")),I=r("4be7");r("5118"),r("f654"),r("4917");function T(t){return new Promise(function(e,r){for(var a,o=[],n=[],i=t.length,l=function(t,r){if(!r.type.match("image/jpeg"))throw alert("Картинки должны быть в формате .jpg"),"Картинки должна быть в формате .jpg";o.push(r);var a=new FileReader;a.onload=function(r){n[t]=r.target.result,--i,console.log(i),0==i&&(console.log(i),e({filesMas:o,imageSrc:n}))},a.readAsDataURL(r)},s=0;a=t[s];s++)l(s,a)})}var R={data:function(){return{showError:!1,loading:!1,dialog:!1,valid:!1,tovarGroup:this.$route.params.group,titleRules:[function(t){return!!t||"Введите Название товара"}],priceRules:[function(t){return!!t||"Введите цену товара"}],title:"",priceNew:"",priceOld:"",content:"",filesMas:[],imageSrc:[]}},watch:{dialog:function(){this.showError=!1,this.title="",this.priceNew="",this.priceOld="",this.content="",this.filesMas=[],this.imageSrc=[],this.$emit("reload")}},methods:{clockLoadImg:function(){this.$refs.inputPhoto.click()},loadImg:function(t){var e=this;this.showError=!1;t.target.files;try{T(t.target.files).then(function(t){var r=t.filesMas,a=t.imageSrc;e.imageSrc=a,e.filesMas=r})}catch(r){console.log(r)}},addTovar:function(){var t=Object(L["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.$refs.form.validate()&&this.filesMas.length>0)){t.next=4;break}return t.delegateYield(regeneratorRuntime.mark(function t(){var r,a,o,n,i,l,s,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r={title:e.title,priceNew:e.priceNew,priceOld:e.priceOld,deskr:e.content},a=[],t.next=5,f["database"]().ref("tovari").child(e.tovarGroup).push(r);case 5:for(o=t.sent,n=0,i=e.filesMas.length,l=e.tovarGroup,s=function(t){var r=e.filesMas[t].name.slice(e.filesMas[t].name.indexOf(".")),s=f["storage"]().ref("".concat(e.tovarGroup,"/").concat(o.key)).child("".concat(t).concat(r)).put(e.filesMas[t]);s.on(f["storage"].TaskEvent.STATE_CHANGED,function(t){},function(t){},function(){s.snapshot.ref.getDownloadURL().then(function(e){return n++,a[t]=e,new I["Promise"](function(t,e){n==i&&t()})}).then(function(){f["database"]().ref("tovari").child(l).child(o.key).update({roads:a}),e.loading=!1,e.dialog=!1})})},c=0;c<e.filesMas.length;c++)s(c);case 11:case"end":return t.stop()}},t)})(),"t0",2);case 2:t.next=5;break;case 4:this.filesMas.length<=0&&(this.showError=!0);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},G=R,U=(r("9867"),Object(s["a"])(G,M,$,!1,null,"5165a5cb",null)),N=U.exports,P=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-dialog",{attrs:{width:"800px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-btn",{staticClass:"success",attrs:{slot:"activator"},slot:"activator"},[t._v("Изменить товар")]),r("v-card",[r("v-container",[r("v-layout",[r("v-flex",{attrs:{"xs-12":""}},[r("v-card-title",[r("h1",[t._v("Добавление товара")])])],1)],1),t.loading?r("div",{staticClass:"text-xs-center"},[r("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}})],1):r("v-layout",[r("v-flex",{attrs:{"xs-12":""}},[r("v-card-text",[r("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{label:"Название",required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{label:"Цена",required:""},model:{value:t.priceNew,callback:function(e){t.priceNew=e},expression:"priceNew"}})],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-text-field",{attrs:{label:"Старая цена(можно оставить пустым)"},model:{value:t.priceOld,callback:function(e){t.priceOld=e},expression:"priceOld"}})],1),r("v-flex",{attrs:{xs12:"",md4:""}},[r("v-btn",{attrs:{color:"warning"},on:{click:t.clickLoadImg}},[r("v-icon",{attrs:{left:""}},[t._v("cloud_upload")]),t._v("загрузить другие картинки\n                    ")],1),r("input",{ref:"inputPhoto",staticStyle:{display:"none"},attrs:{type:"file",name:"photo",id:"photo",accept:".jpg",multiple:""},on:{change:t.loadImg}})],1)],1)],1)],1),r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:"","align-start":"","justify-start":"","fill-height":""}},t._l(t.imageSrc,function(t){return r("v-flex",{key:t,attrs:{xs12:"",md2:""}},[r("img",{attrs:{src:t,alt:""}})])}),1)],1),r("h1",[t._v("Описание")]),r("quill-editor",{ref:"myTextEditor",model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"error"},on:{click:t.cancel}},[t._v("ОТменить")]),r("v-btn",{attrs:{color:"success"},on:{click:t.changeTovar}},[t._v("Сохранить изменения")])],1)],1)],1)],1)],1)],1)},C=[],q={props:["id"],data:function(){return{loading:!1,dialog:!1,valid:!1,title:"",priceNew:"",priceOld:"",content:"",filesMas:[],imageSrc:[],imageSrcFromFb:[],tovarGroup:this.$route.params.group}},watch:{dialog:function(){var t=this;this.filesMas=[],this.imageSrc=[],f["database"]().ref("tovari").child(this.tovarGroup).child(this.id).once("value").then(function(e){t.content=e.val().deskr,t.title=e.val().title,t.priceNew=e.val().priceNew,t.priceOld=e.val().priceOld,t.imageSrcFromFb=e.val().roads})}},methods:{clickLoadImg:function(){this.$refs.inputPhoto.click()},changeTovar:function(){var t=this;if(this.$refs.form.validate()){var e={title:this.title,priceNew:this.priceNew,priceOld:this.priceOld,deskr:this.content};if(f["database"]().ref("tovari").child(this.tovarGroup).child(this.id).update(e).then(function(t){console.log(" ок")}),this.filesMas.length>0){var r=function(e,r){for(var a=f["storage"]().ref(),o=r.length,n=0;n<o;n++){var i=a.child("".concat(t.tovarGroup,"/").concat(e,"/").concat(n,".jpg"));i.delete().then(function(){console.log("Топчик")}).catch(function(t){console.log(t)})}},a=function(){var e=[];t.loading=!0;for(var r=0,a=t.filesMas.length,o=t.tovarGroup,n=function(n){var i=t.filesMas[n].name.slice(t.filesMas[n].name.indexOf(".")),l=f["storage"]().ref("".concat(t.tovarGroup,"/").concat(t.id)).child("".concat(n).concat(i)).put(t.filesMas[n]);l.on(f["storage"].TaskEvent.STATE_CHANGED,function(t){},function(t){},function(){l.snapshot.ref.getDownloadURL().then(function(t){return r++,e[n]=t,new Promise(function(t,e){r==a&&t()})}).then(function(){f["database"]().ref("tovari").child(o).child(t.id).update({roads:e}),t.loading=!1,0==t.loading&&(t.$emit("reload"),t.dialog=!1)})})},i=0;i<t.filesMas.length;i++)n(i)};r(this.id,this.imageSrcFromFb),a()}else this.$emit("reload"),this.dialog=!1}},cancel:function(){this.dialog=!1,this.filesMas=[],this.imageSrc=[]},loadImg:function(t){var e=this;t.target.files;try{T(t.target.files).then(function(t){var r=t.filesMas,a=t.imageSrc;e.imageSrc=a,e.filesMas=r})}catch(r){console.log(r)}}}},A=q,D=(r("20ad"),Object(s["a"])(A,P,C,!1,null,null,null)),F=D.exports,z={props:["group","name"],data:function(){return{tovarList:{}}},components:{addTovar:N,uppdateTovar:F},created:function(){var t=this;f["database"]().ref("tovari").child(this.group).once("value").then(function(e){t.tovarList=e.val()})},methods:{dellTovar:function(t,e){var r=f["storage"]().ref(),a=e.length;f["database"]().ref("tovari").child(this.group).child(t).remove();for(var o=0;o<a;o++){var n=r.child("".concat(this.group,"/").concat(t,"/").concat(o,".jpg"));n.delete().then(function(){console.log("Топчик")}).catch(function(t){console.log(t)})}this.reload()},reload:function(){var t=this;f["database"]().ref("tovari").child(this.group).once("value").then(function(e){t.tovarList=e.val()})}}},H=z,B=Object(s["a"])(H,j,S,!1,null,null,null),J=B.exports;a["default"].use(d["a"]);var K=new d["a"]({mode:"history",base:"",routes:[{name:"Home",path:"/",component:E,props:!0,beforeEnter:v},{name:"Login",path:"/login",component:x},{name:"GroupItem",path:"/GroupItem/:group",component:J,props:!0,beforeEnter:v},{path:"*",redirect:"/login"}]}),W=r("2f62"),V=r("d225"),X=function t(e){Object(V["a"])(this,t),this.id=e},Y={state:{user:null},mutations:{setUser:function(t,e){t.user=e}},actions:{loginUser:function(){var t=Object(L["a"])(regeneratorRuntime.mark(function t(e,r){var a,o,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,o=r.email,n=r.password,a("clearError"),a("setLoading",!0),t.prev=4,t.next=7,f["auth"]().signInWithEmailAndPassword(o,n);case 7:i=t.sent,a("setUser",i),a("setLoading",!1),t.next=17;break;case 12:throw t.prev=12,t.t0=t["catch"](4),a("setLoading",!1),a("setError",t.t0.message),t.t0;case 17:case"end":return t.stop()}},t,null,[[4,12]])}));function e(e,r){return t.apply(this,arguments)}return e}(),autologinUser:function(t,e){var r=t.commit;r("setUser",new X(e.uid))},logout:function(t){var e=t.commit;f["auth"]().signOut(),e("setUser",null)}},getters:{user:function(t){return t.user},isUserLogedIn:function(t){return null!==t.user}}},Q={state:{loading:!1,error:null},mutations:{setLoading:function(t,e){t.loading=e},setError:function(t,e){t.error=e},clearError:function(t){t.error=null}},actions:{setLoading:function(t,e){var r=t.commit;r("setLoading",e)},setError:function(t,e){var r=t.commit;r("setError",e)},clearError:function(t){var e=t.commit;e("clearError")}},getters:{loading:function(t){return t.loading},error:function(t){return t.error}}};a["default"].use(W["a"]);var Z=new W["a"].Store({modules:{User:Y,Common:Q}}),tt=r("ce5b"),et=r.n(tt),rt=(r("bf40"),r("953d")),at=r.n(rt);r("a753"),r("8096"),r("14e1");a["default"].use(at.a,{modules:{toolbar:[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}]]}}),a["default"].use(et.a),a["default"].config.productionTip=!1;var ot,nt={apiKey:"AIzaSyDs8Wqxf5K5eVnkP5XB_FtzeekD0D2MmMo",authDomain:"my-project-1501683622618.firebaseapp.com",databaseURL:"https://my-project-1501683622618.firebaseio.com",projectId:"my-project-1501683622618",storageBucket:"my-project-1501683622618.appspot.com",messagingSenderId:"1032386855643",appId:"1:1032386855643:web:2830c5d4de06b9ff"};f["initializeApp"](nt),f["auth"]().onAuthStateChanged(function(t){ot||(ot=new a["default"]({beforeCreate:function(){t&&this.$store.dispatch("autologinUser",t)},router:K,store:Z,render:function(t){return t(u)}}).$mount("#app"))})},6151:function(t,e,r){},9867:function(t,e,r){"use strict";var a=r("257b"),o=r.n(a);o.a}});
//# sourceMappingURL=app.10c2f377.js.map