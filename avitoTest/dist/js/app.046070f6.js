(function(t){function e(e){for(var r,a,c=e[0],o=e[1],l=e[2],d=0,p=[];d<c.length;d++)a=c[d],n[a]&&p.push(n[a][0]),n[a]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],r=!0,c=1;c<i.length;c++){var o=i[c];0!==n[o]&&(r=!1)}r&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var r={},n={app:0},s=[];function a(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=r,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(i,r,function(e){return t[e]}.bind(null,r));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var r=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("Header"),t.loading?i("div",{staticClass:"d-flex justify-content-center align-items-center",staticStyle:{width:"95vw",height:"80vh"}},[i("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Large Spinner"}})],1):i("main",[i("Filters",{on:{changeKateg:t.changeCateg,changePrice:t.changePrice,changeFav:t.changeFav}}),i("Sorts",{on:{changeDirectionSort:t.changeDirectionSort,changeTypeSort:t.changeTypeSort}}),i("section",{staticClass:"pt-4 pb-4"},[i("b-container",{staticClass:"container"},[i("h1",[t._v("Товаров: "+t._s(t.productFiltered.length))])])],1),i("section",{staticClass:"products"},[i("div",{staticClass:"container products__wrapper"},t._l(t.collection,function(e){return i("Product",{key:e.id,attrs:{product:e,salers:t.findSalers(e.relationships.seller)}})}),1),i("div",{staticClass:"container"},[i("div",{staticClass:"btn-toolbar d-flex justify-content-center mb-5"},[i("div",{staticClass:"btn-group"},t._l(t.pagination.pages,function(e){return i("button",{key:e,staticClass:"btn btn-primary",on:{click:function(i){return i.preventDefault(),t.setPage(e)}}},[t._v(t._s(e))])}),0)])])])],1)],1)},s=[],a=(i("7514"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",{staticClass:"mb-4",staticStyle:{"max-width":"22rem"},attrs:{"img-src":t.product.pictures[0],"img-top":"",tag:"article"}},[i("b-card-text",{staticClass:"product__body"},[i("div",{staticClass:"product__col-photo"},[t._v(t._s(t.product.pictures.length))]),i("div",{staticClass:"product__title-wrap"},[i("h4",[t._v(t._s(t.product.title))]),i("div",{staticClass:"product__heart",class:{"product__heart-favourite":t.isFavourite},on:{click:t.togleFavourite}},[i("svg",{attrs:{viewBox:"0 -28 512 512",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:t.svg}})])])]),i("div",{staticClass:"product__price"},[t._v(t._s(t._f("capitalize")(t.product.price)))]),i("div",{staticClass:"product__salers salers mt-1"},[i("div",{staticClass:"salers__name"},[t._v(t._s(t.salers.name))]),i("div",{staticClass:"salers__rating"},[t._v(t._s(t.salers.rating))])])])],1)}),c=[],o=(i("6762"),i("2fdb"),i("6b54"),i("a481"),{name:"Product",props:["product","salers"],data:function(){return{isFavourite:!1,svg:"M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0"}},filters:{capitalize:function(t){if(t)return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{togleFavourite:function(){this.isFavourite?(this.svg="M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0",this.isFavourite=!1,this.$store.commit("removeFavourites",this.product.id)):(this.svg="M255 490l-36-36C87 337 0 258 0 161 0 82 61 20 140 20c44 0 87 21 115 54 28-33 71-54 115-54 79 0 140 62 140 141 0 97-87 176-219 293l-36 36z",this.isFavourite=!0,this.$store.commit("addFavourites",this.product.id))}},mounted:function(){this.$store.state.favorites.includes(this.product)?(this.isFavourite=!0,this.svg="M255 490l-36-36C87 337 0 258 0 161 0 82 61 20 140 20c44 0 87 21 115 54 28-33 71-54 115-54 79 0 140 62 140 141 0 97-87 176-219 293l-36 36z"):(this.isFavourite=!1,this.svg="M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0")}}),l=o,u=(i("7cd1"),i("2877")),d=Object(u["a"])(l,a,c,!1,null,null,null),p=d.exports,f=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},h=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("header",{staticClass:"header"},[r("div",{staticClass:"container d-flex justify-content-between align-items-center pt-2 pb-2"},[r("h1",{staticClass:"header__logo"},[t._v("Авито")]),r("div",{staticClass:"header__favourite"},[r("img",{attrs:{src:i("8616"),alt:""}})])])])}],v={},g=Object(u["a"])(v,f,h,!1,null,null,null),_=g.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"options-block pt-4 pb-4"},[i("b-container",[i("div",{staticClass:"options-block__header pb-1"},[t._v("Отфильтровать по:")]),i("b-row",{staticClass:"options-block__options-wrap"},[i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"3"}},[i("div",{staticClass:"filter__header"},[t._v("Категории:")]),i("div",{staticClass:"filter__controls"},[i("b-form-select",{staticClass:"filter__select",attrs:{name:"categoris"},on:{change:t.changeKateg},model:{value:t.categ,callback:function(e){t.categ=e},expression:"categ"}},[i("option",{attrs:{value:""}},[t._v("Все категории")]),i("option",{attrs:{value:"immovable"}},[t._v("Недвижимость")]),i("option",{attrs:{value:"cameras"}},[t._v("Камеры")]),i("option",{attrs:{value:"auto"}},[t._v("Автомобили")]),i("option",{attrs:{value:"laptops"}},[t._v("Ноутбуки")])])],1)]),i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"4"}},[i("div",{staticClass:"filter__header"},[t._v("Цена:")]),i("div",{staticClass:"filter__controls filter-price"},[i("div",{staticClass:"filter-price__block"},[i("span",[t._v("c")]),i("b-form-input",{staticClass:"filter-price__input ml-2",attrs:{type:"number"},on:{input:t.changePrice},model:{value:t.beginPrice,callback:function(e){t.beginPrice=t._n("string"===typeof e?e.trim():e)},expression:"beginPrice"}})],1),i("div",{staticClass:"filter-price__block"},[i("span",[t._v("по")]),i("b-form-input",{staticClass:"filter-price__input ml-2",attrs:{type:"number"},on:{input:t.changePrice},model:{value:t.endPrice,callback:function(e){t.endPrice=t._n("string"===typeof e?e.trim():e)},expression:"endPrice"}})],1)])]),i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"5"}},[i("div",{staticClass:"filter__header"},[t._v("Избранные:")]),i("div",{staticClass:"filter__controls"},[i("div",[t._v("Показать только избранные:")]),i("b-form-checkbox",{staticClass:"filter__chekbox ml-2",on:{change:t.changeFav},model:{value:t.showFav,callback:function(e){t.showFav=e},expression:"showFav"}})],1)])],1)],1)],1)},b=[];i("c5f6"),i("55dd"),i("ac6a");function S(t){var e=t.filter(function(t){return t.price}),i=0;return e.forEach(function(t){t["price"]>i&&(i=t["price"])}),i}function P(t){var e=t.filter(function(t){return t.price});return console.log("Меня вызвали"),e.reduce(function(t,e){return e.price<t?e.price:t},e[0].price)}function C(t,e,i,r,n,s,a){return t.filter(function(t){return!e||t.category==e}).filter(function(t){return!t.price||Number(t.price)>=i&&Number(t.price)<=r}).sort(function(t,e){if("rating"==n){console.log(t.relationships.seller);var i=s(t.relationships.seller).rating,r=s(e.relationships.seller).rating;return"up"==a?i>r?1:-1:i<r?1:-1}if("price"==n){var c=t.price,o=e.price;return"up"==a?c>o?1:-1:c<o?1:-1}})}var y={data:function(){return{categ:"",beginPrice:0,endPrice:0,showFav:!1,products:this.$store.state.products}},mounted:function(){this.beginPrice=P(this.products),this.endPrice=S(this.products);var t=this.beginPrice,e=this.endPrice;this.$emit("changePrice",{begprice:t,endPrice:e})},methods:{changeKateg:function(){var t=this;this.$emit("changeKateg",this.categ);var e=this.products.filter(function(e){return!t.categ||e.category==t.categ});this.beginPrice=P(e),this.endPrice=S(e),this.changePrice()},changePrice:function(){this.$emit("changePrice",{begprice:this.beginPrice,endPrice:this.endPrice})},changeFav:function(){var t=this;if(this.$emit("changeFav",!this.showFav),this.showFav){var e=this.products.filter(function(e){return!t.categ||e.category==t.categ});this.beginPrice=P(e),this.endPrice=S(e),this.changePrice()}else this.beginPrice=P(this.$store.state.favorites),this.endPrice=S(this.$store.state.favorites),this.changePrice()}}},w=y,x=Object(u["a"])(w,m,b,!1,null,null,null),F=x.exports,k=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"options-block"},[i("b-container",{staticClass:"container options-block__wrap"},[i("div",{staticClass:"options-block__header pb-1"},[t._v("Отсортировать по:")]),i("div",{staticClass:"options-block__options-wrap"},[i("div",{staticClass:"filter mb-3 mb-md-0"},[i("div",{staticClass:"filter__controls"},[i("b-form-select",{staticClass:"filter__select mr-3",on:{change:t.changeTypeSort},model:{value:t.typeSort,callback:function(e){t.typeSort=e},expression:"typeSort"}},[i("option",{attrs:{value:"rating"}},[t._v("По популярности (рейтинг продавца)")]),i("option",{attrs:{value:"price"}},[t._v("По цене")])]),i("b-form-select",{staticClass:"filter__select",on:{change:t.changeDirectionSort},model:{value:t.directionSort,callback:function(e){t.directionSort=e},expression:"directionSort"}},[i("option",{attrs:{value:"down"}},[t._v("По убывания")]),i("option",{attrs:{value:"up"}},[t._v("По возрастанию")])])],1)])])])],1)},$=[],O={data:function(){return{typeSort:"price",directionSort:"down"}},methods:{changeDirectionSort:function(){this.$emit("changeDirectionSort",this.directionSort)},changeTypeSort:function(){this.$emit("changeTypeSort",this.typeSort)}}},j=O,M=Object(u["a"])(j,k,$,!1,null,null,null),z=M.exports,T=i("ec99"),E=i.n(T),J=i("f5fe"),N=i.n(J),D={components:{Product:p,Header:_,Filters:F,Sorts:z},data:function(){return{productsShowed:[],categ:"",beginPrice:0,endPrice:0,typeSort:"price",directionSort:"down",perPage:10,pagination:{}}},created:function(){var t=this;this.$store.dispatch("loadProducts").then(function(){t.productsShowed=t.$store.state.products})},methods:{changePrice:function(t){var e=t.begprice,i=t.endPrice;this.beginPrice=e,this.endPrice=i},changeCateg:function(t){this.categ=t},changeDirectionSort:function(t){this.directionSort=t},changeTypeSort:function(t){this.typeSort=t},changeFav:function(t){this.productsShowed=t?this.favorites:this.$store.state.products},findSalers:function(t){return this.sellers.find(function(e){return e.id==t})},setPage:function(t){this.pagination=this.paginator(this.productFiltered.length,t)},paginate:function(t){return E()(this.productFiltered,this.pagination.startIndex,this.pagination.endIndex+1)},paginator:function(t,e){var i=(e-1)*this.perPage,r=Math.min(i+this.perPage-1,t-1);return{currentPage:e,startIndex:i,endIndex:r,pages:N()(1,Math.ceil(t/this.perPage)+1)}}},watch:{productFiltered:function(){this.setPage(1)}},computed:{loading:function(){return this.$store.state.Common.loading},sellers:function(){return this.$store.state.sellers},favorites:function(){return this.$store.state.favorites},productFiltered:function(){return C(this.productsShowed,this.categ,this.beginPrice,this.endPrice,this.typeSort,this.findSalers,this.directionSort)},collection:function(){return this.paginate(this.productFiltered)}}},I=D,K=(i("5c0b"),Object(u["a"])(I,n,s,!1,null,null,null)),L=K.exports,B=(i("96cf"),i("3b8d")),H=(i("20d6"),i("2f62")),R={state:{loading:!1},mutations:{setLoading:function(t,e){t.loading=e}},getters:{}};r["a"].use(H["a"]);var q=new H["a"].Store({modules:{Common:R},state:{products:[],sellers:[],favorites:[]},mutations:{setProducts:function(t,e){t.products=e},setSellers:function(t,e){t.sellers=e},setFavourites:function(t){localStorage.fav?JSON.parse(localStorage.fav).forEach(function(e){var i=t.products.find(function(t){return t.id==e});t.favorites.push(i)}):localStorage.fav=JSON.stringify([])},addFavourites:function(t,e){var i=JSON.parse(localStorage.fav),r=t.products.find(function(t){return t.id==e});i.push(e),localStorage.fav=JSON.stringify(i),t.favorites.push(r)},removeFavourites:function(t,e){var i=JSON.parse(localStorage.fav),r=i.findIndex(function(t){return t==e});i.splice(r,1),localStorage.fav=JSON.stringify(i),t.favorites.splice(r,1)}},actions:{loadProducts:function(){var t=Object(B["a"])(regeneratorRuntime.mark(function t(e){var i,r,n,s,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=e.commit,i("setLoading",!0),t.next=4,fetch("https://avito.dump.academy/products");case 4:return r=t.sent,t.next=7,r.json();case 7:return n=t.sent,i("setProducts",n.data),t.next=11,fetch("https://avito.dump.academy/sellers");case 11:return s=t.sent,t.next=14,s.json();case 14:a=t.sent,i("setSellers",a.data),i("setFavourites"),i("setLoading",!1);case 18:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},getters:{}}),A=i("498a"),G=i("b1fc"),Q=i("44d4"),U=i("3d31"),V=i("a7e2"),W=i("b519");i("f9e3");r["a"].use(A["a"]),r["a"].use(G["a"]),r["a"].use(Q["a"]),r["a"].use(U["a"]),r["a"].use(V["a"]),r["a"].use(W["a"]),r["a"].config.productionTip=!1,new r["a"]({store:q,render:function(t){return t(L)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var r=i("5e27"),n=i.n(r);n.a},"5e27":function(t,e,i){},"7cd1":function(t,e,i){"use strict";var r=i("eed7"),n=i.n(r);n.a},8616:function(t,e,i){t.exports=i.p+"img/heartFree.5dd1f32a.svg"},eed7:function(t,e,i){}});
//# sourceMappingURL=app.046070f6.js.map