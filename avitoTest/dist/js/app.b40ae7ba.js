(function(t){function e(e){for(var r,c,s=e[0],o=e[1],l=e[2],p=0,d=[];p<s.length;p++)c=s[p],n[c]&&d.push(n[c][0]),n[c]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);u&&u(e);while(d.length)d.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],r=!0,s=1;s<i.length;s++){var o=i[s];0!==n[o]&&(r=!1)}r&&(a.splice(e--,1),t=c(c.s=i[0]))}return t}var r={},n={app:0},a=[];function c(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.m=t,c.c=r,c.d=function(t,e,i){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(c.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(i,r,function(e){return t[e]}.bind(null,r));return i},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=o;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var r=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("Header"),t.loadData?i("main",[i("Filters",{attrs:{products:t.products},on:{changeKateg:t.changeCateg,changePrice:t.changePrice,changeFav:t.changeFav}}),i("Sorts",{on:{changeDirectionSort:t.changeDirectionSort,changeTypeSort:t.changeTypeSort}}),i("section",{staticClass:"pt-4 pb-4"},[i("b-container",{staticClass:"container"},[i("h1",[t._v("Товаров: "+t._s(t.productFiltered.length))])])],1),i("section",{staticClass:"products"},[i("div",{staticClass:"container products__wrapper"},t._l(t.collection,function(e){return i("Product",{key:e.id,attrs:{product:e,salers:t.findSalers(e.relationships.seller)}})}),1),i("div",{staticClass:"container"},[i("div",{staticClass:"btn-toolbar d-flex justify-content-center mb-5"},[i("div",{staticClass:"btn-group"},t._l(t.pagination.pages,function(e){return i("button",{key:e,staticClass:"btn btn-primary",on:{click:function(i){return i.preventDefault(),t.setPage(e)}}},[t._v(t._s(e))])}),0)])])])],1):i("div",{staticClass:"d-flex justify-content-center align-items-center",staticStyle:{width:"95vw",height:"80vh"}},[i("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{label:"Large Spinner"}})],1)],1)},a=[],c=(i("c5f6"),i("55dd"),i("ac6a"),i("7514"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",{staticClass:"mb-4",staticStyle:{"max-width":"22rem"},attrs:{"img-src":t.product.pictures[0],"img-top":"",tag:"article"}},[i("b-card-text",{staticClass:"product__body"},[i("div",{staticClass:"product__col-photo"},[t._v(t._s(t.product.pictures.length))]),i("div",{staticClass:"product__title-wrap"},[i("h4",[t._v(t._s(t.product.title))]),i("div",{staticClass:"product__heart",class:{"product__heart-favourite":t.isFavourite},on:{click:t.togleFavourite}},[i("svg",{attrs:{viewBox:"0 -28 512 512",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:t.svg}})])])]),i("div",{staticClass:"product__price"},[t._v(t._s(t._f("capitalize")(t.product.price)))]),i("div",{staticClass:"product__salers salers mt-1"},[i("div",{staticClass:"salers__name"},[t._v(t._s(t.salers.name))]),i("div",{staticClass:"salers__rating"},[t._v(t._s(t.salers.rating))])])])],1)}),s=[],o=(i("6762"),i("2fdb"),i("20d6"),i("6b54"),i("a481"),{name:"Product",props:["product","salers"],data:function(){return{isFavourite:!1,svg:"M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0"}},created:function(){},filters:{capitalize:function(t){if(t)return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}},methods:{togleFavourite:function(){var t=this;if(this.isFavourite){this.svg="M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0",this.isFavourite=!1;var e=JSON.parse(localStorage.fav),i=e.findIndex(function(e){return e==t.product.id});e.splice(i,1),localStorage.fav=JSON.stringify(e)}else{this.svg="M255 490l-36-36C87 337 0 258 0 161 0 82 61 20 140 20c44 0 87 21 115 54 28-33 71-54 115-54 79 0 140 62 140 141 0 97-87 176-219 293l-36 36z",this.isFavourite=!0;var r=JSON.parse(localStorage.fav);r.push(this.product.id),localStorage.fav=JSON.stringify(r)}}},mounted:function(){if(localStorage.fav){var t=JSON.parse(localStorage.fav);t.includes(this.product.id)?this.isFavourite=!0:this.isFavourite=!1}else localStorage.fav=JSON.stringify([])},watch:{isFavourite:function(t){this.svg=t?"M255 490l-36-36C87 337 0 258 0 161 0 82 61 20 140 20c44 0 87 21 115 54 28-33 71-54 115-54 79 0 140 62 140 141 0 97-87 176-219 293l-36 36z":"M256 456c-7 0-14-3-20-8l-58-50c-52-44-96-82-127-119-35-42-51-82-51-125 0-42 14-81 41-109C67 16 103 0 143 0c30 0 57 9 80 28 13 9 23 20 33 34 10-14 21-25 33-34 23-19 50-28 80-28 40 0 76 16 102 45 27 28 41 67 41 109 0 43-16 83-51 125-31 37-75 75-127 119l-58 50c-6 5-13 8-20 8zM143 30c-31 0-60 12-80 35-21 23-33 54-33 89 0 36 14 69 44 105 29 36 73 73 123 116l59 51 59-51c50-43 94-80 123-116 30-36 44-69 44-105 0-35-12-66-33-89-20-23-49-35-80-35-23 0-44 7-62 21-17 13-28 29-35 41-3 5-9 9-16 9s-13-4-16-9c-7-12-18-28-35-41a99 99 0 0 0-62-21zm0 0"}}}),l=o,u=(i("7cd1"),i("2877")),p=Object(u["a"])(l,c,s,!1,null,null,null),d=p.exports,f=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},h=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("header",{staticClass:"header"},[r("div",{staticClass:"container d-flex justify-content-between align-items-center pt-2 pb-2"},[r("h1",{staticClass:"header__logo"},[t._v("Авито")]),r("div",{staticClass:"header__favourite"},[r("img",{attrs:{src:i("8616"),alt:""}})])])])}],v={},g=Object(u["a"])(v,f,h,!1,null,null,null),_=g.exports,b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"options-block pt-4 pb-4"},[i("b-container",[i("div",{staticClass:"options-block__header pb-1"},[t._v("Отфильтровать по:")]),i("b-row",{staticClass:"options-block__options-wrap"},[i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"3"}},[i("div",{staticClass:"filter__header"},[t._v("Категории:")]),i("div",{staticClass:"filter__controls"},[i("b-form-select",{staticClass:"filter__select",attrs:{name:"categoris"},on:{change:t.changeKateg},model:{value:t.categ,callback:function(e){t.categ=e},expression:"categ"}},[i("option",{attrs:{value:""}},[t._v("Все категории")]),i("option",{attrs:{value:"immovable"}},[t._v("Недвижимость")]),i("option",{attrs:{value:"cameras"}},[t._v("Камеры")]),i("option",{attrs:{value:"auto"}},[t._v("Автомобили")]),i("option",{attrs:{value:"laptops"}},[t._v("Ноутбуки")])])],1)]),i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"4"}},[i("div",{staticClass:"filter__header"},[t._v("Цена:")]),i("div",{staticClass:"filter__controls filter-price"},[i("div",{staticClass:"filter-price__block"},[i("span",[t._v("c")]),i("b-form-input",{staticClass:"filter-price__input ml-2",attrs:{type:"number"},on:{input:t.changePrice},model:{value:t.beginPrice,callback:function(e){t.beginPrice=t._n("string"===typeof e?e.trim():e)},expression:"beginPrice"}})],1),i("div",{staticClass:"filter-price__block"},[i("span",[t._v("по")]),i("b-form-input",{staticClass:"filter-price__input ml-2",attrs:{type:"number"},on:{input:t.changePrice},model:{value:t.endPrice,callback:function(e){t.endPrice=t._n("string"===typeof e?e.trim():e)},expression:"endPrice"}})],1)])]),i("b-col",{staticClass:"filter mb-3 mb-md-0",attrs:{lg:"5"}},[i("div",{staticClass:"filter__header"},[t._v("Избранные:")]),i("div",{staticClass:"filter__controls"},[i("div",[t._v("Показать только избранные:")]),i("b-form-checkbox",{staticClass:"filter__chekbox ml-2",on:{change:t.changeFav},model:{value:t.showFav,callback:function(e){t.showFav=e},expression:"showFav"}})],1)])],1)],1)],1)},m=[];function S(t){var e=t.filter(function(t){return t.price}),i=0;return e.forEach(function(t){t["price"]>i&&(i=t["price"])}),i}function C(t){var e=t.filter(function(t){return t.price});return e.reduce(function(t,e){return e.price<t?e.price:t},e[0].price)}var y={props:["products"],data:function(){return{categ:"",beginPrice:0,endPrice:0,showFav:!1}},mounted:function(){this.beginPrice=C(this.products),this.endPrice=S(this.products);var t=this.beginPrice,e=this.endPrice;this.$emit("changePrice",{begprice:t,endPrice:e})},methods:{changeKateg:function(){var t=this;this.$emit("changeKateg",this.categ);var e=this.products.filter(function(e){return!t.categ||e.category==t.categ});this.beginPrice=C(e),this.endPrice=S(e),this.changePrice()},changePrice:function(){var t=this.beginPrice,e=this.endPrice;this.$emit("changePrice",{begprice:t,endPrice:e})},changeFav:function(){this.$emit("changeFav",!this.showFav)}}},P=y,w=Object(u["a"])(P,b,m,!1,null,null,null),x=w.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"options-block"},[i("b-container",{staticClass:"container options-block__wrap"},[i("div",{staticClass:"options-block__header pb-1"},[t._v("Отсортировать по:")]),i("div",{staticClass:"options-block__options-wrap"},[i("div",{staticClass:"filter mb-3 mb-md-0"},[i("div",{staticClass:"filter__controls"},[i("b-form-select",{staticClass:"filter__select mr-3",on:{change:t.changeTypeSort},model:{value:t.typeSort,callback:function(e){t.typeSort=e},expression:"typeSort"}},[i("option",{attrs:{value:"rating"}},[t._v("По популярности (рейтинг продавца)")]),i("option",{attrs:{value:"price"}},[t._v("По цене")])]),i("b-form-select",{staticClass:"filter__select",on:{change:t.changeDirectionSort},model:{value:t.directionSort,callback:function(e){t.directionSort=e},expression:"directionSort"}},[i("option",{attrs:{value:"down"}},[t._v("По убывания")]),i("option",{attrs:{value:"up"}},[t._v("По возрастанию")])])],1)])])])],1)},O=[],k={data:function(){return{typeSort:"price",directionSort:"down"}},methods:{changeDirectionSort:function(){this.$emit("changeDirectionSort",this.directionSort)},changeTypeSort:function(){this.$emit("changeTypeSort",this.typeSort)}}},j=k,M=Object(u["a"])(j,F,O,!1,null,null,null),$=M.exports,z=i("ec99"),D=i.n(z),J=i("f5fe"),N=i.n(J),T={components:{Product:d,Header:_,Filters:x,Sorts:$},data:function(){return{products:[],productsOrig:[],sellers:[],categ:"",loadData:!1,beginPrice:0,endPrice:0,showFav:!1,typeSort:"price",directionSort:"down",perPage:10,pagination:{}}},mounted:function(){var t=this;fetch("https://avito.dump.academy/products").then(function(t){return t.json()}).then(function(e){var i=e.data;t.products=i,t.productsOrig=i}).then(function(){return fetch("https://avito.dump.academy/sellers")}).then(function(t){return t.json()}).then(function(e){var i=e.data;t.sellers=i,t.loadData=!0})},methods:{changePrice:function(t){var e=t.begprice,i=t.endPrice;this.beginPrice=e,this.endPrice=i},changeCateg:function(t){this.categ=t},changeDirectionSort:function(t){this.directionSort=t},changeTypeSort:function(t){this.typeSort=t},findSalers:function(t){return this.sellers.find(function(e){return e.id==t})},changeFav:function(t){var e=this;if(t){var i=[];JSON.parse(localStorage.fav).forEach(function(t){var r=e.productsOrig.find(function(e){return e.id==t});i.push(r)}),this.products=i}else this.products=this.productsOrig},setPage:function(t){this.pagination=this.paginator(this.productFiltered.length,t)},paginate:function(t){return D()(this.productFiltered,this.pagination.startIndex,this.pagination.endIndex+1)},paginator:function(t,e){var i=(e-1)*this.perPage,r=Math.min(i+this.perPage-1,t-1);return{currentPage:e,startIndex:i,endIndex:r,pages:N()(1,Math.ceil(t/this.perPage)+1)}}},watch:{productFiltered:function(){this.setPage(1)}},computed:{productFiltered:function(){var t=this;return this.products.filter(function(e){return!t.categ||e.category==t.categ}).filter(function(e){return!e.price||Number(e.price)>=t.beginPrice&&Number(e.price)<=t.endPrice}).sort(function(e,i){if("rating"==t.typeSort){var r=t.findSalers(e.relationships.seller).rating,n=t.findSalers(i.relationships.seller).rating;return"up"==t.directionSort?r>n?1:-1:r<n?1:-1}if("price"==t.typeSort){var a=e.price,c=i.price;return"up"==t.directionSort?a>c?1:-1:a<c?1:-1}})},collection:function(){return this.paginate(this.productFiltered)}}},E=T,I=(i("5c0b"),Object(u["a"])(E,n,a,!1,null,null,null)),K=I.exports,B=i("498a"),H=i("b1fc"),L=i("44d4"),q=i("3d31"),A=i("a7e2"),G=i("b519");i("f9e3");r["a"].use(B["a"]),r["a"].use(H["a"]),r["a"].use(L["a"]),r["a"].use(q["a"]),r["a"].use(A["a"]),r["a"].use(G["a"]),r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(K)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var r=i("5e27"),n=i.n(r);n.a},"5e27":function(t,e,i){},"7cd1":function(t,e,i){"use strict";var r=i("eed7"),n=i.n(r);n.a},8616:function(t,e,i){t.exports=i.p+"img/heartFree.5dd1f32a.svg"},eed7:function(t,e,i){}});
//# sourceMappingURL=app.b40ae7ba.js.map